import { getPhotographers } from "../pages/index.js";
import { getPhotographer } from "../pages/photographer.js";

export async function displayPhotographerMedia() {
	const photographers = await getPhotographers();
	const photographer = await getPhotographer();
	const photographerName = photographer.name.replace(/\s+/g, "_");
	const mediaContainer = document.querySelector(".media-container");
	let totalLikes = 0;

	for (let i = 0; i < photographers.media.length; i++) {
		
		const media = photographers.media[i];

		if (photographer.id === media.photographerId) {

			function getMediaCardDOM (media) {

				const { title, likes } = media;
				const mediaElement = document.createElement("div");
				mediaElement.classList.add("media");

				if (media.image) {
					const { image } = media;
					const imagePath = `assets/images/${photographerName}/${image}`;
					const imageElement = document.createElement("img");
					imageElement.setAttribute("src", imagePath);
					imageElement.setAttribute("alt", title);
					const mediaImage = document.createElement("div");
					mediaImage.classList.add("media_image");
					mediaImage.appendChild(imageElement);
					const a = document.createElement("a");
					a.appendChild(mediaImage);
					a.setAttribute("href", "#");
					mediaElement.appendChild(a);
				}

				if (media.video) {
					const { video } = media;
					const videoPath = `assets/images/${photographerName}/${video}`;
					const videoElement = document.createElement("video");
					videoElement.setAttribute("src", videoPath);
					videoElement.setAttribute("alt", title);
					videoElement.setAttribute("controls", "");
					const mediaImage = document.createElement("div");
					mediaImage.classList.add("media_video");
					mediaImage.appendChild(videoElement);
					const a = document.createElement("a");
					a.appendChild(mediaImage);
					a.setAttribute("href", "#");
					mediaElement.appendChild(a);
				}

				const mediaInfo = document.createElement("div");
				mediaInfo.classList.add("media_info");
				const mediaTitle = document.createElement("h2");
				mediaTitle.classList.add("media_title");
				mediaTitle.textContent = title;
				const mediaLikes = document.createElement("div");
				mediaLikes.classList.add("media_likes");
				mediaLikes.innerHTML = `${likes} <i class="fas fa-heart"></i>`;
				mediaInfo.appendChild(mediaTitle);
				mediaInfo.appendChild(mediaLikes);
				mediaElement.appendChild(mediaInfo);
				mediaContainer.appendChild(mediaElement);

				totalLikes += parseInt(likes);

				return (mediaContainer);
			}
			return getMediaCardDOM();
		}
	}
	const bottomInfo = document.querySelector(".bottom-info");
	const likesElement = document.createElement("p");
	likesElement.innerHTML = `${totalLikes} <i class="fas fa-heart"></i>`;
	const priceElement = document.createElement("p");
	priceElement.textContent = `${photographer.price} â‚¬/jour`;
	bottomInfo.innerHTML = "";
	bottomInfo.appendChild(likesElement);
	bottomInfo.appendChild(priceElement);
}